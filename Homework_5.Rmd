---
title: "Homwework_5"
author: "Laura_Calvimontes"
date: "2024-11-13"
output: html_document
---
```{r setup, include=TRUE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
```


```{r Load_Packages-libraries, include=FALSE}
library(knitr)
library(ggplot2)
library(ggthemes)
library(dbplyr)
library(tidyverse)
library(tidyr)
library(broom)
library(purrr)
```

Cleaning data 
```{r Q1 Reding Homicide data}
url <- paste0("https://raw.githubusercontent.com/washingtonpost/",
              "data-homicides/refs/heads/master/homicide-data.csv")

homicides <- read_csv(file = url)
head(homicides, n = 5)

#mutate a new column
homicides_2 <- homicides %>% 
  mutate(city_name = paste(city, state, sep=", ") ) %>% 
  mutate(reported_date = ymd(reported_date)) %>% 
  mutate(total_hom = if_else(disposition == "Closed without arrest"| disposition == "Closed by arrest", TRUE, FALSE))
homicides_2

```

```{r baltimore}

baltimore <- homicides_2 %>% 
              filter(city == "Baltimore") %>% 
              mutate(reported_month = month(reported_date)) %>% 
              mutate(temperature =ifelse(reported_month %in% c(11,12,1,2,3,4), "Winter", "Summer"))
baltimore 

arrest <- as.Date("2015-04-30")
```

```{r}
baltimore_time <- ggplot(baltimore, aes(x = reported_date, fill = temperature))+
  geom_histogram( bins = 108) +
  #geom_freqpoly(stat = "bin", color = "blue")+
  ggtitle("Homicides in Baltimore, MD") +
  scale_fill_manual(values = c("Summer" = "gray", "Winter" = "skyblue"))+
  theme_grey()+
  theme(legend.position = "bottom",
        legend.title = element_blank())+
  geom_vline(xintercept = arrest, linetype="dashed", color = "red", size= 0.5)+

  
baltimore_time 

  
```
